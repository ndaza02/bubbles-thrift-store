<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout â€” Bubbles' Thrift</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- Fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Playfair+Display:ital,wght@0,400;0,500;0,600;0,700;1,400&display=swap"
        rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        brand: {
                            primary: '#052e16',
                            accent: '#d4af37',
                            cream: '#fafaf9',
                            surface: '#f5f5f4',
                            text: '#334155',
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        serif: ['Playfair Display', 'serif'],
                    }
                }
            }
        }
    </script>
</head>

<body class="bg-brand-cream text-brand-text font-sans antialiased">

    <div
        class="max-w-7xl mx-auto bg-white min-h-screen relative shadow-soft rounded-[2rem] my-8 overflow-hidden ring-1 ring-black/5 flex flex-col">

        <!-- Minimal Header -->
        <nav class="px-8 py-8 border-b border-brand-primary/5 flex items-center justify-between">
            <a href="index.html" class="flex items-center gap-3">
                <div class="w-8 h-8 bg-brand-primary text-brand-accent rounded-full flex items-center justify-center">
                    <i data-lucide="crown" class="w-4 h-4"></i>
                </div>
                <span class="text-2xl font-serif font-bold text-brand-primary tracking-tight">Bubbles' Thrift</span>
            </a>
            <div class="text-xs uppercase tracking-widest font-bold text-brand-primary/40 flex items-center gap-4">
                <span>Cart</span>
                <i data-lucide="chevron-right" class="w-3 h-3"></i>
                <span class="text-brand-primary">WhatsApp Checkout</span>
            </div>
        </nav>

        <main class="flex-1 p-8 lg:p-12">
            <div class="grid grid-cols-1 lg:grid-cols-12 gap-16" id="checkoutGrid">

                <!-- Left: Forms -->
                <div class="lg:col-span-7 space-y-12">
                    <section>
                        <h2 class="text-3xl font-serif text-brand-primary mb-8 flex items-center gap-4">
                            <span
                                class="w-10 h-10 bg-brand-primary text-brand-accent rounded-full flex items-center justify-center text-sm font-sans italic">01</span>
                            Shipping Information
                        </h2>
                        <form class="grid grid-cols-1 md:grid-cols-2 gap-6" id="shippingForm">
                            <div class="md:col-span-1">
                                <label class="block text-xs font-bold uppercase tracking-wider text-gray-400 mb-2">First
                                    Name</label>
                                <input type="text" id="firstName" placeholder="Jane" required
                                    class="w-full bg-brand-surface border border-brand-primary/10 rounded-xl px-4 py-4 focus:ring-2 focus:ring-brand-accent/20 outline-none">
                            </div>
                            <div class="md:col-span-1">
                                <label class="block text-xs font-bold uppercase tracking-wider text-gray-400 mb-2">Last
                                    Name</label>
                                <input type="text" id="lastName" placeholder="Doe" required
                                    class="w-full bg-brand-surface border border-brand-primary/10 rounded-xl px-4 py-4 focus:ring-2 focus:ring-brand-accent/20 outline-none">
                            </div>
                            <div class="md:col-span-2">
                                <label class="block text-xs font-bold uppercase tracking-wider text-gray-400 mb-2">Email
                                    Address</label>
                                <input type="email" id="email" placeholder="jane@example.com" required
                                    class="w-full bg-brand-surface border border-brand-primary/10 rounded-xl px-4 py-4 focus:ring-2 focus:ring-brand-accent/20 outline-none">
                            </div>
                            <div class="md:col-span-2">
                                <label
                                    class="block text-xs font-bold uppercase tracking-wider text-gray-400 mb-2">Shipping
                                    Address</label>
                                <input type="text" id="address" placeholder="123 Luxury Ave, Suite 400" required
                                    class="w-full bg-brand-surface border border-brand-primary/10 rounded-xl px-4 py-4 focus:ring-2 focus:ring-brand-accent/20 outline-none">
                            </div>
                            <div>
                                <label
                                    class="block text-xs font-bold uppercase tracking-wider text-gray-400 mb-2">City</label>
                                <input type="text" id="city" placeholder="New York" required
                                    class="w-full bg-brand-surface border border-brand-primary/10 rounded-xl px-4 py-4 focus:ring-2 focus:ring-brand-accent/20 outline-none">
                            </div>
                            <div>
                                <label
                                    class="block text-xs font-bold uppercase tracking-wider text-gray-400 mb-2">Postcode</label>
                                <input type="text" id="postcode" placeholder="10001" required
                                    class="w-full bg-brand-surface border border-brand-primary/10 rounded-xl px-4 py-4 focus:ring-2 focus:ring-brand-accent/20 outline-none">
                            </div>
                        </form>
                    </section>

                    <section>
                        <h2 class="text-3xl font-serif text-brand-primary mb-8 flex items-center gap-4">
                            <span
                                class="w-10 h-10 bg-brand-primary text-brand-accent rounded-full flex items-center justify-center text-sm font-sans italic">02</span>
                            Order Confirmation
                        </h2>
                        <div
                            class="bg-brand-surface p-10 rounded-[2.5rem] border border-brand-primary/5 flex flex-col items-center text-center space-y-6">
                            <div
                                class="w-20 h-20 bg-green-500/10 text-green-600 rounded-full flex items-center justify-center">
                                <i data-lucide="message-circle" class="w-10 h-10"></i>
                            </div>
                            <h3 class="text-2xl font-serif text-brand-primary">Send via WhatsApp</h3>
                            <p class="text-gray-500 max-w-sm">After clicking the button below, we'll generate a message
                                with your order details for you to send to our concierge.</p>
                            <div
                                class="flex items-center gap-4 p-4 bg-white/50 rounded-2xl border border-brand-primary/5 text-[10px] text-gray-400 leading-relaxed uppercase tracking-widest text-left">
                                <i data-lucide="info" class="w-6 h-6 text-brand-accent shrink-0"></i>
                                <p>We'll confirm your total and shipping once we receive your message. Payment will be
                                    arranged via WhatsApp.</p>
                            </div>
                        </div>
                    </section>

                    <button id="placeOrder"
                        class="w-full bg-brand-accent text-brand-primary text-lg font-bold py-6 rounded-full shadow-xl hover:scale-[1.01] active:scale-95 transition-all flex items-center justify-center gap-3">
                        <i data-lucide="send" class="w-5 h-5"></i>
                        Complete Order on WhatsApp
                    </button>
                </div>

                <!-- Right: Summary -->
                <div class="lg:col-span-5">
                    <div class="sticky top-12 bg-brand-surface rounded-[2.5rem] p-10 border border-brand-primary/5">
                        <h3 class="font-serif text-2xl text-brand-primary mb-8 pb-4 border-b border-brand-primary/10">
                            Order Summary</h3>

                        <div id="summaryItems"
                            class="space-y-6 mb-8 max-h-[400px] overflow-y-auto pr-2 custom-scrollbar">
                            <!-- Injected by JS -->
                        </div>

                        <div class="space-y-4 pt-6 border-t border-brand-primary/10 text-brand-primary/70">
                            <div class="flex justify-between">
                                <span class="text-sm font-medium">Subtotal</span>
                                <span class="font-bold text-brand-primary" id="summarySubtotal">$0.00</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-sm font-medium uppercase tracking-widest text-[10px]">Shipping</span>
                                <span class="text-brand-accent font-bold text-xs uppercase">Calculated in Chat</span>
                            </div>
                            <div class="flex justify-between text-2xl pt-4 border-t border-brand-primary/5">
                                <span class="font-serif text-brand-primary font-bold">Total</span>
                                <span class="font-serif text-brand-primary font-bold" id="summaryTotal">$0.00</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Success State -->
            <div id="successState"
                class="hidden py-32 text-center max-w-xl mx-auto space-y-8 animate-in fade-in zoom-in duration-700">
                <div
                    class="w-24 h-24 bg-brand-primary text-brand-accent rounded-full flex items-center justify-center mx-auto shadow-2xl relative">
                    <i data-lucide="check" class="w-12 h-12"></i>
                </div>
                <div>
                    <h2 class="text-5xl font-serif text-brand-primary mb-4">Message Generated!</h2>
                    <p class="text-gray-500 text-lg">Your browser should have opened WhatsApp. If not, click the button
                        below to retry.</p>
                </div>
                <div class="pt-8 flex flex-col gap-4">
                    <button id="retryWhatsApp"
                        class="bg-brand-accent text-brand-primary px-10 py-4 rounded-full font-bold shadow-soft hover:scale-105 transition-transform">Retry
                        WhatsApp</button>
                    <a href="index.html" class="text-brand-primary font-bold hover:underline">Return Home</a>
                </div>
            </div>
        </main>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const cart = JSON.parse(localStorage.getItem('bubbles_thrift_cart')) || [];
            if (cart.length === 0 && !document.getElementById('successState').classList.contains('hidden')) {
                window.location.href = 'index.html';
            }

            const summaryItems = document.getElementById('summaryItems');
            const summarySubtotal = document.getElementById('summarySubtotal');
            const summaryTotal = document.getElementById('summaryTotal');

            const updateSummary = () => {
                summaryItems.innerHTML = cart.map(item => `
                    <div class="flex gap-4 group">
                        <div class="w-16 h-20 bg-white rounded-xl overflow-hidden shrink-0 shadow-sm">
                            <img src="${item.image}" class="w-full h-full object-cover">
                        </div>
                        <div class="flex-1">
                            <h4 class="font-serif text-brand-primary leading-tight text-sm">${item.name}</h4>
                            <p class="text-[10px] text-gray-400 uppercase tracking-widest mt-1">${item.brand}</p>
                            <div class="flex justify-between items-center mt-2">
                                <span class="text-xs text-brand-primary/60 font-medium">Qty: ${item.quantity}</span>
                                <span class="text-sm font-bold text-brand-primary">$${(item.price * item.quantity).toFixed(2)}</span>
                            </div>
                        </div>
                    </div>
                `).join('');

                const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
                summarySubtotal.textContent = `$${total.toFixed(2)}`;
                summaryTotal.textContent = `$${total.toFixed(2)}`;
            };

            function generateWhatsAppURL() {
                const firstName = document.getElementById('firstName').value;
                const lastName = document.getElementById('lastName').value;
                const address = document.getElementById('address').value;
                const city = document.getElementById('city').value;
                const postcode = document.getElementById('postcode').value;

                let message = `*NEW ORDER FROM BUBBLES' THRIFT*\n\n`;
                message += `*Customer Details:*\n`;
                message += `Name: ${firstName} ${lastName}\n`;
                message += `Address: ${address}, ${city}, ${postcode}\n\n`;

                message += `*Order Summary:*\n`;
                cart.forEach(item => {
                    message += `- ${item.name} (${item.brand}) x${item.quantity}: $${(item.price * item.quantity).toFixed(2)}\n`;
                });

                const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
                message += `\n*TOTAL: $${total.toFixed(2)}*`;

                const phone = "263777442441"; // Client's specific phone number
                return `https://wa.me/${phone}?text=${encodeURIComponent(message)}`;
            }

            const placeOrderBtn = document.getElementById('placeOrder');
            placeOrderBtn.addEventListener('click', () => {
                const form = document.getElementById('shippingForm');
                if (!form.checkValidity()) {
                    form.reportValidity();
                    return;
                }

                const url = generateWhatsAppURL();
                window.open(url, '_blank');

                document.getElementById('checkoutGrid').classList.add('hidden');
                document.getElementById('successState').classList.remove('hidden');

                document.getElementById('retryWhatsApp').onclick = () => window.open(url, '_blank');

                // Keep cart for retry, but could clear it if user returns home
                // localStorage.removeItem('bubbles_thrift_cart');
            });

            updateSummary();
            lucide.createIcons();
        });
    </script>
    <style>
        .custom-scrollbar::-webkit-scrollbar {
            width: 4px;
        }

        .custom-scrollbar::-webkit-scrollbar-track {
            background: transparent;
        }

        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #052e1610;
            border-radius: 10px;
        }
    </style>
</body>

</html>